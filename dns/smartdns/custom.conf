# Add custom settings here.
# please read https://pymumu.github.io/smartdns/config/basic-config/
# log-level info
# log-console yes
# log-file /var/log/smartdns/smartdns.log

user nobody
server-name smartdns

# 禁用 IPv6 查询
force-AAAA-SOA yes
# 双栈 IP 优选
dualstack-ip-selection no

# 缓存设置
# cache-size 32768
# cache-persist yes
# 缓存预获取
prefetch-domain yes

# iOS系统解析缓慢问题怎么解决？  配置关闭TYPE65记录查询
# force-qtype-SOA 65

# 解析本地主机名称
mdns-lookup yes
# dnsmasq-lease-file /tmp/dhcp.leases

# 启用仪表盘
plugin smartdns_ui.so
# 设置服务端口号。
smartdns-ui.ip http://[::]:6080
# 数据文件存储路径
data-dir /var/lib/smartdns
# 设置最长查询日志保留时间，单位为秒
smartdns-ui.max-query-log-age 86400

### Default Group 默认分组，保证非CN域名正常解析
# cloudflare
server-https https://cloudflare-dns.com/dns-query
server-tls tls://one.one.one.one -group ddns
server-tls tls://1dot1dot1dot1.cloudflare-dns.com -group ddns
# google
server-https https://dns.google/dns-query
server-tls tls://dns.google
# CMLiussss DoH 镜像服务
# https://doh.cmliussss.net/
server-https https://doh.cmliussss.com/CMLiussss
server-https https://doh.cmliussss.net/CMLiussss



### dns-cn 国内 DNS 分组
# 阿里云 DNS
server-quic quic://dns.alidns.com -group dns-cn -exclude-default-group
server-https https://dns.alidns.com/dns-query -group dns-cn -exclude-default-group
server-tls tls://dns.alidns.com -group dns-cn -exclude-default-group
# 腾讯云 DNS
server-https https://sm2.doh.pub/dns-query -group dns-cn -exclude-default-group
server-https https://doh.pub/dns-query -group dns-cn -exclude-default-group
server-tls tls://dot.pub -group dns-cn -exclude-default-group
# 360 安全 DNS
server-https https://doh.360.cn/dns-query -group dns-cn -exclude-default-group
server-tls tls://dot.360.cn -group dns-cn -exclude-default-group



### Bootstrap DNS 用于解析 DNS 服务器的域名
server-quic quic://223.5.5.5 -bootstrap-dns -exclude-default-group
server-quic quic://223.6.6.6 -bootstrap-dns -exclude-default-group
server-https https://223.5.5.5/dns-query -bootstrap-dns -exclude-default-group
server-https https://223.6.6.6/dns-query -bootstrap-dns -exclude-default-group
server 114.114.114.114 -bootstrap-dns -exclude-default-group
server 114.114.115.115 -bootstrap-dns -exclude-default-group
server 101.226.4.6 -bootstrap-dns -exclude-default-group
server 123.125.81.6 -bootstrap-dns -exclude-default-group

# fallback
server-https https://doh.090227.xyz/AdG-query -fallback
server-https https://doh.090227.xyz/SB-query -fallback
server-https https://doh.090227.xyz/Next-query -fallback
server-https https://doh.090227.xyz/V-query -fallback
# quad9
server-tls tls://dns.quad9.net -fallback
# opendns
server-https https://doh.opendns.com/dns-query -fallback



# 配置分流规则
# china-list 使用 dns-cn
# https://github.com/Loyalsoldier/v2ray-rules-dat#:~:text=%40felixonmars/dnsmasq%2Dchina%2Dlist%20%E4%BB%93%E5%BA%93%E6%94%B6%E9%9B%86%E7%9A%84%E5%9C%A8%E4%B8%AD%E5%9B%BD%E5%A4%A7%E9%99%86%E5%8F%AF%E7%9B%B4%E8%BF%9E%E7%9A%84%E5%9F%9F%E5%90%8D%E5%88%97%E8%A1%A8%20china%2Dlist.txt%EF%BC%9A
# wget https://raw.githubusercontent.com/Loyalsoldier/v2ray-rules-dat/release/china-list.txt -O /etc/smartdns/download/china-list.txt
domain-set -name china-list -file '/etc/smartdns/download/china-list.txt'
domain-rules /domain-set:china-list/ -nameserver dns-cn

domain-rules /*.dpdns.org/ -no-cache -nameserver ddns
domain-rules /*.xyz/ -no-cache -nameserver ddns
domain-rules /*.eu.org/ -no-cache -nameserver ddns